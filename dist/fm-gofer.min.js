!function(e,o){"object"==typeof exports&&"undefined"!=typeof module?o(exports):"function"==typeof define&&define.amd?define(["exports"],o):o((e="undefined"!=typeof globalThis?globalThis:e||self).FMGofer={})}(this,(function(e){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var r=function(){return"object"===o(window.fmGofer)&&null!==window.fmGofer&&!Array.isArray(window.fmGofer)},t=function(){return r()?window.fmGofer.callbackName:null},n=function(){window.fmGofer={promises:{},callbackName:null}},i=function(e,o,r,t){var n={resolve:e,reject:o};0!==r&&(n.timeoutID=setTimeout((function(){o(t)}),r));var i="xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,(function(e){var o=16*Math.random()|0;return("x"==e?o:3&o|8).toString(16)}));return window.fmGofer.promises[i]=n,i},f=function(e){return window.fmGofer.promises[e]},l=function(e){return delete window.fmGofer.promises[e]},u=function(e){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";try{"0"===r&&(r=!1);var t=f(e);if(void 0===t)throw new Error("No promise found for promiseID ".concat(e,"."));t.timeoutID&&clearTimeout(t.timeoutID),r?t.reject(o):t.resolve(o),l(e)}catch(e){console.error(e),alert(e)}},c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"fmGoferD7738642C91848E08720EAC24EDDA483";if("string"!=typeof e||!e)throw new Error("callbackName must be a non-empty string");r()||n(),window[e]=u,window.fmGofer.callbackName=e},a=function(e,r,t){var n,i;"object"!==o(window.FileMaker)?(n=setInterval((function(){"object"===o(window.FileMaker)&&(clearTimeout(i),clearInterval(n),window.FileMaker.PerformScriptWithOption(e,r,t))}),5),i=setTimeout((function(){throw clearInterval(n),new Error("window.FileMaker not found")}),2e3)):window.FileMaker.PerformScriptWithOption(e,r,t)},m=3e3,s="The FM script call timed out",d=function(e){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,f=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:m,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:s;if("string"!=typeof e||!e)throw new Error("script must be a string");if("number"!=typeof l)throw new Error("timeout must be a number");if("string"!=typeof u)throw new Error("timeoutMessage must be a string");return new Promise((function(m,s){r()||n(),t()||c();var d=i(m,s,l,u),w=t(),p=JSON.stringify({promiseID:d,callbackName:w,parameter:o});a(e,p,f)}))},w=function(e){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:m,t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:s,n=void 0;return d(e,o,n,r,t)},p={PerformScript:w,PerformScriptWithOption:d};e.PerformScript=w,e.PerformScriptWithOption=d,e.default=p,Object.defineProperty(e,"__esModule",{value:!0})}));
